name: "Astar Management CodeQL Configuration"

# Disable the default suite to run only security-focused queries
disable-default-queries: false

# Custom query suites for enhanced security analysis
queries:
  - name: security-extended
    uses: security-extended
  - name: security-and-quality
    uses: security-and-quality
  - name: custom-security
    uses: ./.github/codeql/custom-queries/

# Include additional security query packs
packs:
  java:
    - codeql/java-queries:AlertSuppression
    - codeql/java-queries:Security
    - codeql/java-queries:experimental/Security
  javascript:
    - codeql/javascript-queries:AlertSuppression
    - codeql/javascript-queries:Security
    - codeql/javascript-queries:experimental/Security

# Path filters for focused analysis
paths:
  - "backend/src/main/**"
  - "frontend/src/**"
  - "frontend/components/**"
  - "frontend/composables/**"
  - "frontend/stores/**"
  - "frontend/pages/**"
  - "frontend/layouts/**"
  - "frontend/middleware/**"

# Exclude paths that don't need security analysis
paths-ignore:
  - "backend/src/test/**"
  - "frontend/tests/**"
  - "frontend/.nuxt/**"
  - "frontend/dist/**"
  - "frontend/node_modules/**"
  - "**/*.test.ts"
  - "**/*.test.js"
  - "**/*.spec.ts"
  - "**/*.spec.js"
  - "**/stories/**"
  - "**/*.stories.*"

# Custom configuration for specific languages
java:
  # Focus on Spring Boot security patterns
  additional-queries:
    - "java/spring/security"
    - "java/spring/sql-injection"
    - "java/spring/xss"
  
javascript:
  # Vue/Nuxt specific security patterns
  additional-queries:
    - "javascript/vue/security"
    - "javascript/node/security"
    - "javascript/express/security"

# Experimental features for enhanced analysis
experimental:
  # Enable ML-powered vulnerability detection
  ml-powered-queries: true
  # Enhanced data flow analysis
  enhanced-dataflow: true