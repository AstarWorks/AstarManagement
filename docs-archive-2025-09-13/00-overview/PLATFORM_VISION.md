# プラットフォームビジョン - 汎用基盤SaaS + 業界特化テンプレート

## 概要
Astar Managementを、Notionのような汎用的な基盤SaaSプラットフォームとして再定義し、テンプレートによって各業界に特化したソリューションを提供する。

## MVP開発方針
- **基盤SaaS**: 業界に依存しない汎用的な機能
- **法律事務所テンプレート**: 最初の業界特化テンプレートとして実装

---

## 対話セッション記録

### セッション1: コアコンセプトの定義
**日時**: 2025-08-16
**参加者**: プロダクトオーナー、AI Assistant

#### Q1: 基盤プラットフォームの核となる概念は？

**回答**: 
- **ページ/ドキュメントベース** + **データベースベース**のハイブリッドアプローチ
- 核となる4つの概念：
  1. **ドキュメント** - 情報の基本単位
  2. **データベース** - 構造化データの管理
  3. **ビュー** - データの表示形式
  4. **プロパティ** - データの属性定義

**製品のポジショニング**:
- **AI-Agent + Notion + Obsidian** の融合
- Notionの構造化された情報管理
- Obsidianのローカルファースト・ディレクトリベース
- AIエージェントによる自動操作

**主要機能（MVP）**:
1. 案件管理（ワークフロー管理）
2. 請求管理（財務管理）
3. 顧客管理（リレーション管理）
4. 文書管理（ドキュメント管理）
5. **AIエージェント自動操作** - 全機能をAIが操作可能

**技術的特徴**:
- **ローカル/クラウド両対応** - オフラインファーストアーキテクチャ
- **ファイルシステムベース** - Obsidian的なディレクトリ構造
- **データ同期** - ローカルとクラウドの同期機能

---

#### Q2: データ保存形式とファイルシステム構造は？

**回答**:

**データ保存形式**:
- **ドキュメント**: Markdownファイル（.md）として保存
- **データベース**: 
  - MVP: PostgreSQL
  - 将来的にCSVエクスポート/インポート対応
  - デフォルトはPostgreSQL運用

**同期アーキテクチャ**:
- **リアルタイム同期** - コンフリクトが発生しない設計
- Obsidianのクラウド版のような動作
- ローカルでもクラウドでも同じ体験を提供

**バージョン管理**:
- **文章のバージョン管理** - すべての変更履歴を追跡
- ドキュメントの編集履歴を保持
- 特定時点への復元が可能

---

#### Q3: ローカル環境での動作と技術的実現方法は？

**回答**:

**デプロイ形態**:
- **ローカル**: 
  - 内部的にDockerコンテナで動作
  - 必要に応じて我々がセットアップサポート
- **クラウド**: 
  - VMで動作
  - ユーザーはWebアプリケーションとして接続

**データ保存の分離**:
- **文章データ**: すべてMarkdown(.md)ファイルとして保存
- **構造化データ**: PostgreSQLに保存

**AIエージェントのアクセス方法**:
- **API**: JSON形式でのアクセス
- **CLI**: コマンドラインインターフェース経由

---

#### Q4: データ構造の具体例は？

**回答**: **分離型アーキテクチャ**を採用

**データ保存構造**:
- **PostgreSQL**: 構造化データのみを保存（メタデータ、ステータス等）
- **Markdown**: 独立したドキュメントとして存在
- **リレーション**: 
  - PostgreSQLからMarkdownへの参照
  - Markdown内からテーブルへのリレーション埋め込み可能

**Markdownの役割**:
- **長文記録の保存場所**（議事録、詳細メモ、やり取りの記録等）
- あらゆる文書・文章をここで作成
- ドキュメントへのリレーションで管理

**検索機能**:
- **ハイブリッド検索**: PostgreSQL（メタデータ）+ Markdown（全文検索）
- **自然言語検索**: AI-Agentによる自然言語での質問・取得
- **RAG/ElasticSearch**: 膨大な文書から必要な情報を抽出
- **NotebookLM的機能**: 
  - 文書の要約・分析
  - 質問応答
  - 指示実行（ドキュメント作成、テーブル作成等）

**権限管理の重要性**:
- **Discord的なロールベース権限管理**を採用
- 柔軟な権限設定
- ディレクトリ・テーブル単位での権限付与
- kintone/Notionの権限管理の課題を解決

---

#### Q5: Discord的な権限管理システムの詳細は？

**回答**:

**ロール管理**:
- **初期状態**: ロールは0個（業種非依存の設計）
- **テンプレート**: 業種別テンプレートにロール定義を含める
- **カスタマイズ**: ユーザーが自由にロールを作成・編集

**権限モデル**: **パーミッション + スコープ**（Cloudflare/GitHub型）
```
例：
- documents:read::/cases/*     （案件フォルダの読み取り）
- database:write::clients      （顧客DBへの書き込み）
- ai:execute::legal-agent      （法務AIエージェントの実行）
```

**権限の適用**:
- **柔軟なディレクトリ構造**: ユーザーが自由に設計
- **ディレクトリ単位の権限**: 各フォルダにロールを割り当て
- **NASからの移行**: 既存のフォルダ構造をそのまま移行可能
- **ロールベース制御**: ユーザーの追加・変更はロール割り当てのみ

**置き換え対象システム**:
- **NAS**: ファイル共有・管理
- **Word**: 文書作成・編集
- **Excel/スプレッドシート**: データ管理・分析
- **kintone**: ワークフロー・業務アプリ

---

#### Q6: テンプレートシステムと業界特化の仕組みは？

**回答**:

**テンプレートの内容**:
```yaml
法律事務所テンプレート:
  ロール定義:
    - 所長弁護士
    - アソシエイト弁護士
    - パラリーガル
    - 事務員
  
  ディレクトリ構造:
    /cases/         # 案件
    /clients/       # 顧客
    /documents/     # 書類
    /billing/       # 請求
  
  データベーススキーマ:
    - cases（案件テーブル）
    - clients（顧客テーブル）
    - invoices（請求テーブル）
  
  ドキュメントテンプレート:
    - 訴状.md
    - 準備書面.md
    - 契約書.md
  
  AIエージェント設定:
    - 法務文書作成エージェント
    - 判例検索エージェント
  
  ワークフロー:
    - 新規案件受任フロー
    - 請求書発行フロー
```

**テンプレート適用方式**: **追加型（Additive）**
- チェックボックスで必要な要素を選択
- 既存環境に追加（置換なし）
- 複数テンプレートの組み合わせ可能
- 段階的な機能追加をサポート

**展開戦略**:
- **現在**: 法律事務所の完璧な実装に集中
- **将来**: 不動産管理、物流など
- **長期**: テンプレート・AIエージェントマーケットプレイス

---

#### Q7: MVPの4つの主要機能の汎用化は？

**回答**:

**1. プロジェクト管理**（案件管理の汎用化）
- 進捗管理が必要な作業単位
- 業種別の適用例：
  - エンジニア: アプリケーション開発プロジェクト
  - 法律事務所: 案件
  - 営業代行: 商材ごとの営業活動

**2. 会計管理**（請求管理の汎用化）
- 収支・時間・経費の統合管理
- **3軸フィルター**:
  - 会社全体
  - 個人（個人事業主対応）
  - プロジェクト
- 用途例：
  - 一般企業: 勤怠管理、経費申請
  - 法律事務所: 実費管理、タイムチャージ

**3. 顧客管理**（CRM機能）
- 外部とのインタラクション記録
- 連絡履歴の時系列管理
- HubSpot的な営業管理機能

**4. 文書管理**（Markdownベース）
- **変数システム**（プラットフォーム機能）:
  - グローバル変数
  - プロジェクト変数
- ディレクトリとプロジェクトの紐付け
- テンプレートでサンプル変数を提供

---

#### Q8: AIエージェントの設計と能力は？

**回答**:

**エージェント構成**:
- **基本エージェント**: 単一の汎用エージェント（我々が提供）
  - MCPツール/CLIツールを使用して機能拡張
  - ユーザーは選択不要（常に同じエージェント）
  - サイドバーからいつでも呼び出し可能

**エージェントの権限**:
- **人間と同等のロールベース権限**
- エージェント専用のロールを保持
- 権限外の操作は承認リクエスト
- 自律/自動実行モードの選択可能

**双方向タスク管理**:
- **人間→エージェント**: タスクの指示
- **エージェント→人間**: タスクのアサイン
  - 例：物理的な作業（銀行への書類提出等）
  - 適切な担当者へチケット作成

**インターフェース**:
- **MVP**: 自然言語チャット（最優先）
- **将来**: API呼び出し対応

**学習機能**:
- ファインチューニング（可能な組織）
- 組織内文書からの学習
- RAGによる情報検索（全組織で利用可能）

---

#### Q9: 技術アーキテクチャとデータ同期は？

**回答**:

**AIエージェント実行環境**: **ハイブリッド型**
- エージェントごとにプロバイダー固定
- 機密用エージェント: ローカルLLM
- 基本エージェント: クラウド（Azure等、学習しないプロバイダー）
- デフォルト: クラウド型（追加費用でローカルLLM支援）

**リアルタイム同期**:
- **WebSocket**使用
- MVP: 単一ファイルの同時編集制限
- プレーンテキストベースでコンフリクト最小化
- Write時点での瞬時同期

**ファイルストレージ**:
- ローカル/クラウド両対応
- **ハイブリッド型マルチテナント**アーキテクチャ
  - Starter: Shared DB + RLS（コスト効率重視）
  - Professional: Dedicated Schema（中規模向け）
  - Enterprise: Dedicated Container（高セキュリティ）
- Kubernetes/Dockerによる柔軟なデプロイ
- オンプレミス構築も対応

**スケーラビリティ**:
- 1組織: 1-100ユーザー
- ドキュメント: 10,000-1,000,000
- **柔軟な分離戦略**（RLS/Schema/Container）
- toB優先、一般消費者は後回し

---

#### 技術選択に対するAI Assistantの見解

**妥当性 ✅**
1. **ハイブリッド型マルチテナント**: セキュリティと効率性の最適バランス
2. **段階的アプローチ**: toBから始めるのは賢明
3. **ハイブリッドAI**: 柔軟性とセキュリティのバランスが良い

**懸念点と対策 ⚠️**
1. **テナント管理の複雑性**: 
   - Kubernetes Operatorで自動化
   - 統一管理インターフェース構築
   
2. **ファイルシステムのスケール**:
   - ElasticSearchでインデックス作成
   - 100万ドキュメントでも問題なし
   
3. **一般消費者対応**:
   - 最初から抽象化層を設計
   - 後からマルチテナント化可能に

**個人的意見 💭**
- **正しい選択**: 複雑さを避けてシンプルに始める
- **法律事務所に最適**: 柔軟な分離レベルで様々な規模に対応
- **Obsidian的アプローチ**: ファイルベースは直感的
- リソース効率と拡張性の両立を実現

このアーキテクチャなら確実に動くMVPが作れます！

---

#### Q10: MVPの実装優先順位とUI/UXは？

**回答**:

**実装優先順位（調整版）**:
```
Phase 1（即価値提供）:
1. 認証・権限管理
2. ファイルシステム + VSCode風エディタ ← 優先実装中
3. 会計機能（実費管理） ← 優先実装中

Phase 2（基盤強化）:
4. PostgreSQLとの連携
5. 変数システム
6. プロジェクト管理

Phase 3（AI統合）:
7. AIエージェント基盤
8. 自然言語インターフェース
9. RAG/検索機能

Phase 4（機能拡充）:
10. 顧客管理
```

**UI構成**:
```
┌─────────────────────────────────────────────┐
│  ロゴ    検索バー         ユーザーメニュー   │
├──────┬─────────────────────────┬────────────┤
│      │                         │            │
│ File │   メインコンテンツ      │    AI      │
│ Tree │   - VSCodeエディタ      │   Chat     │
│      │   - カンバンボード      │            │
│      │   - データテーブル      │            │
│      │                         │            │
└──────┴─────────────────────────┴────────────┘
  左サイドバー    ワークスペース    右サイドバー
```

**デモ戦略**:
- **投資家向け**: 自然言語での複雑な操作実行
- **弁護士向け**: すぐ使える簡単な機能
- **差別化ポイント**: 「プロダクトでできることは全てAIができる」

---

#### Q11: VSCode風エディタと会計機能の具体的な実装は？

**回答**:

**エディタ機能（Obsidian寄り）**:
```yaml
最低限の機能:
  - Markdown編集
  - 変数埋め込み（{{variable}}）
  - 検索・置換
  
追加予定:
  - シンタックスハイライト
  - リアルタイムプレビュー
  - テンプレート機能
```

**会計機能のMVPスコープ**:
```yaml
必須機能:
  - 実費記録（交通費、印紙代等）
  - 案件への紐付け
  - 簡単な集計表示
  
あると嬉しい:
  - CSVインポート
  - 領収書画像アップロード
  - 月次レポート
```

**MD↔PostgreSQL双方向リレーション**:
- Markdown→DB: 動的データ埋め込み
  ```markdown
  {{accounting.getExpenses(project_id, month)}}
  ```
- DB→Markdown: ファイルへの参照
- **権限チェック**: データ取得時に必ず実行

**ユーザーテスト優先順位**:
1. **B**: 実費入力→月次集計（最優先）
2. **A**: Word→Markdown変換
3. **C**: AI検索
※ ほぼ同時提供を目指す

---

#### Q12: ビジネスモデルと価格戦略は？

**回答**:

**収益モデル**: **SaaS型（$/user/month）**

**価格設定**: 
- **1,000-2,000円/ユーザー/月**
- 小中規模法律事務所（1-10名）に最適化

**AIエージェント課金**:
- **基本料金に含まれるプール制**
- 追加課金なしでAI利用可能

**競合優位性**:
1. **AIエージェントネイティブ**: 最初からAI前提の設計
2. **シンプルな機能**: アプリ知識不要
3. **シームレスな統合**: AIが全機能にアクセス可能
4. **情報アクセス**: AIが組織の全データを活用

**なぜ既存ツールの組み合わせではダメか**:
- 既存ツール: AIのアクセス範囲が限定的
- 本プラットフォーム: AIが全てを操作・実行可能

**成長戦略（同時展開）**:
- **横展開**: 司法書士、他士業
- **業界展開**: 物流業界
- **グローバル**: YC採択を目指す

---

#### Q13: MVP実装の具体的なタイムラインとマイルストーンは？

**回答**:

**MVPスコープ**:
```yaml
必須機能:
  1. ユーザー認証・ロール管理
  2. ファイルシステム + Markdownエディタ
  3. 実費管理（会計機能）
  4. 基本的なプロジェクト管理
  5. AIチャット（基本的な質問応答）
```

**開発タイムライン**:
- **1ヶ月後**: ファイルシステム + 実費管理（最低限動作）
- **3ヶ月後**: AIエージェント基本動作
- **6ヶ月後**: 4機能 + AIエージェント完全統合

**チーム構成**:
- **現在**: 3名
  - プロダクトオーナー
  - UI/コンポーネント開発者
  - バックエンド開発者
- **採用予定**: フロントエンド + バックエンド各1名

**主要リスク**:
- **技術**: AIとの統合の複雑さ、動作の不確実性
- **ビジネス**: 
  - 法律事務所の保守性
  - 現顧客の維持
  - キャッシュフロー

**成功指標**:
- **MVP**: 3社との有料契約
- **1ヶ月後**: 3社契約
- **3ヶ月後**: 10社契約
- **展開**: 営業 + 海外コミュニティ展開
- **目標**: 問い合わせ不要で即利用可能な状態

---

## まとめ：プラットフォームビジョン

### 製品コンセプト
**AI-Agent + Notion + Obsidian** の融合
- 汎用基盤SaaS + 業界テンプレート
- AIエージェントネイティブ設計
- ローカル/クラウド両対応

### ターゲット
- **初期**: 小中規模法律事務所（1-10名）
- **展開**: 司法書士、物流、グローバル（YC採択目指す）

### 差別化要因
1. **AIが全機能を操作可能**
2. **シンプルで学習コスト最小**
3. **既存NASからの移行が容易**
4. **完全なデータ分離でセキュア**

### ビジネスモデル
- **SaaS型**: 1,000-5,000円/ユーザー/月（プランによる）
- **AI利用**: 基本料金に含まれるプール制
- **柔軟な分離レベル**: 
  - Starter: Shared DB + RLS（1,000円〜）
  - Professional: Dedicated Schema（2,000円〜）
  - Enterprise: Dedicated Container（5,000円〜）

### 技術選択
- **Frontend**: Nuxt.js 3, Vue 3, TypeScript
- **Backend**: Spring Boot, Kotlin, PostgreSQL
- **ファイル**: Markdown + ファイルシステム
- **AI**: ハイブリッド（クラウド/ローカル）

このビジョンなら、確実に革新的なプラットフォームが実現できます！