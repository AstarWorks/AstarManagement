# 実費入力画面 要件定義書

## 1. 概要

法律事務所における実費（交通費、印紙代、コピー代など）の入力・管理機能の要件を定義します。

## 2. ビジネス要件

### 2.1 背景と目的
- **現状の課題**: （要確認）
- **目標**: 実費の記録と請求書への反映を効率化

### 2.2 主な利用者
- 弁護士
- 事務員
- 経理担当者

## 3. 機能要件

### 3.1 実費の種類
- 交通費（電車、バス、タクシー、ガソリン代など）
- 印紙代
- コピー代
- 郵送費
- その他

### 3.2 入力項目

#### 必須項目
- **日付**: 実費が発生した日付
- **科目**: 実費の種類（交通費、印紙代など）
- **摘要**: 実費の詳細説明
- **収入金額**: 収入がある場合の金額（通常は0円）
- **支出金額**: 支出金額
- **差引残額**: 前の記録からの累計残高（自動計算）
  - ※列の表示/非表示を切り替え可能

#### 追加項目
- **案件**: どの案件に紐づく実費か（案件選択）
- **メモ**: 補足情報や備考

### 3.3 入力方法

#### 基本入力
- **モバイル優先の1件入力**: スマートフォンで素早く入力できるUI
- **PC向け一括入力**: 必要に応じて複数件をまとめて入力

#### CSVインポート機能
- **対象**: 個人のクレジットカード明細、銀行口座履歴
- **処理フロー**:
  1. CSVファイルのアップロード
  2. 自動的にデータを解析・表示
  3. 事業関連の支出を高速で選別（チェックボックス等で選択）
  4. 選択したものを一括で実費として登録
- **フォーマット対応**:
  - 主要な金融機関のCSVフォーマットに対応
  - ユーザーによるヘッダー変換ルールの設定機能
  - 将来的にAIによる自動変換ルール生成（MVP後）

#### 裏付け資料
- **領収書・請求書等の画像アップロード機能**
- **対応形式**: JPG, PNG, PDF
- **各実費記録に紐付けて保存**

### 3.4 承認フロー
- **MVP段階**: 承認不要（入力後即座に反映）
- **将来対応**: 大規模事務所向けに承認機能を追加予定

### 3.5 データ活用機能

#### 集計・レポート機能
- **集計単位**: 案件別、弁護士別、期間別、事務所全体
- **MVP段階**: シンプルな集計表示
- **将来対応**: 請求書への実費転記機能

#### 検索・絞り込み機能
- **検索条件**:
  - 期間（日付範囲）
  - 案件
  - 科目
  - 金額範囲
- **実装方針**: MVP段階ではフロントエンドでのフィルタリング

#### データ管理機能
- **編集**: 入力済み実費の修正機能
- **削除**: 入力済み実費の削除機能（論理削除）
- **エクスポート**: CSV、PDF形式でのデータ出力

## 4. 非機能要件

### 4.1 パフォーマンス
- **一覧表示**: 1ページあたり30件表示（ページネーション対応）
- **CSVインポート**: 最大500件の一括処理に対応
- **レスポンスタイム**: 通常操作で1秒以内

### 4.2 セキュリティ
- **データ保護**: 暗号化通信（HTTPS）
- **アクセス制御**: テナント単位でのデータ分離
- **監査ログ**: 実費データの変更履歴を記録

### 4.3 ユーザビリティ
- **モバイル対応**: レスポンシブデザイン
- **入力補助**: 過去の入力履歴からのサジェスト機能
- **エラー処理**: わかりやすいエラーメッセージ

## 5. 画面構成（概要）

### 5.1 実費一覧画面
- 実費データの一覧表示
- 検索・絞り込み機能
- 新規入力、編集、削除ボタン
- エクスポートボタン

### 5.2 実費入力画面
- シンプルな入力フォーム（モバイル最適化）
- 裏付け資料のアップロード
- 入力内容の確認・保存

### 5.3 CSVインポート画面
- ファイルアップロード
- データプレビュー・選択
- インポート実行

### 5.4 集計レポート画面
- 集計条件の選択
- 結果表示（表・グラフ）
- エクスポート機能