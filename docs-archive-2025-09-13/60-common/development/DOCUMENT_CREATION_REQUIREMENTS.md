# 書類作成画面 - 要件定義

## 概要

法律事務所での書類作成を効率化するため、VSCode風のMarkdownエディターを採用し、テンプレート機能と変数差し込み機能を提供します。

## 基本方針

### 1. エディター
- **VSCode風Markdownエディター**を採用
- プレビュー機能付き（リアルタイムプレビュー）
- シンタックスハイライト
- 自動補完機能

### 2. テンプレート機能
- **カスタマイズ可能なテンプレート**
- 基本テンプレートをシステムで提供
- 事務所独自のテンプレート作成・編集が可能
- テンプレートの共有とバージョン管理

### 3. データ差し込み
- **シンプルな変数置換方式**
- {{変数名}}形式で記述
- 案件情報、当事者情報を自動差し込み
- プレビューで確認可能

## 主要機能

### 1. エディター機能

#### 1.1 基本編集機能
- Markdown記法サポート
- リアルタイムプレビュー（画面分割）
- シンタックスハイライト
- 行番号表示
- 検索・置換（Ctrl+F / Ctrl+H）
- 元に戻す・やり直し（Ctrl+Z / Ctrl+Y）

#### 1.2 補助機能
- 自動保存（30秒ごと）
- 下書き保存
- バージョン履歴
- エクスポート（PDF、Word、HTML）

#### 1.3 ショートカット
- VSCodeと同じキーバインド
- カスタマイズ可能
- チートシート表示

### 2. テンプレート管理

#### 2.1 システムテンプレート
法律事務所でよく使う書類のテンプレートを提供：
- 訴状
- 答弁書
- 準備書面
- 申立書
- 契約書
- 委任状
- 内容証明郵便

#### 2.2 カスタムテンプレート
- 既存テンプレートの編集
- 新規テンプレート作成
- カテゴリー分類
- 検索機能
- インポート/エクスポート

#### 2.3 テンプレート要素
- タイトル
- 説明
- カテゴリー
- 変数定義
- 本文（Markdown）
- メタデータ（作成者、更新日など）

### 3. 変数差し込み機能

#### 3.1 利用可能な変数

**案件情報：**
- {{案件番号}}
- {{案件名}}
- {{受任日}}
- {{事件類型}}

**当事者情報：**
- {{原告名}}
- {{原告住所}}
- {{被告名}}
- {{被告住所}}
- {{代理人名}}

**事務所情報：**
- {{事務所名}}
- {{弁護士名}}
- {{事務所住所}}
- {{事務所電話番号}}

**日付関連：**
- {{今日}}
- {{作成日}}
- {{提出期限}}

#### 3.2 変数の使用方法
```markdown
# 訴状

令和{{年}}年（ワ）第{{事件番号}}号
{{事件名}}事件

原告 {{原告名}}
被告 {{被告名}}

{{今日}}

{{裁判所名}}　御中

原告訴訟代理人
弁護士 {{弁護士名}}
```

### 4. プレビュー機能

#### 4.1 表示モード
- エディターのみ
- プレビューのみ
- 分割表示（左右/上下）
- 同期スクロール

#### 4.2 プレビュースタイル
- 裁判所提出書類風
- 一般文書風
- カスタムCSS対応

### 5. 書類の保存と管理

#### 5.1 保存形式
- Markdown形式（.md）で保存
- メタデータはフロントマターに記録
- 添付ファイルは別管理

#### 5.2 フォルダ構造
```
/documents
  /cases
    /2024-001
      - 訴状_v1.md
      - 訴状_v2.md
      - 準備書面1.md
  /templates
    /system
    /custom
  /drafts
```

#### 5.3 バージョン管理
- 自動バージョニング
- 変更履歴の記録
- 差分表示
- 任意のバージョンに戻す

### 6. エクスポート機能

#### 6.1 対応フォーマット
- PDF（裁判所提出用フォーマット）
- Microsoft Word (.docx)
- HTML
- プレーンテキスト

#### 6.2 エクスポート設定
- 用紙サイズ（A4）
- 余白設定
- フォント設定
- ヘッダー/フッター
- ページ番号

### 7. AI連携機能（将来実装）

#### 7.1 文章校正
- 誤字脱字チェック
- 法律用語の適切性確認
- 文体の統一性チェック

#### 7.2 文章生成支援
- 定型文の提案
- 類似判例の引用提案
- 論理構成のチェック

## ユーザーインターフェース要件

### 1. レイアウト
- VSCode風の3ペインレイアウト
- サイドバー（ファイルエクスプローラー）
- エディターエリア
- プレビューエリア

### 2. ダークモード対応
- システム設定に追従
- 手動切り替えも可能

### 3. レスポンシブ対応
- タブレットでの編集対応
- モバイルは閲覧のみ

## セキュリティ要件

### 1. アクセス制御
- 案件担当者のみ編集可能
- 閲覧権限の細かい設定

### 2. データ保護
- 自動保存データの暗号化
- 通信の暗号化（HTTPS）

### 3. 監査ログ
- 編集履歴の記録
- アクセスログの記録