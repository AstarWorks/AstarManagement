# M1-T6 â€“ REST Controllers & DTO Layer

## Goal
Expose plaintext folder/document CRUD endpoints for the editor module, wired behind the feature toggle and returning the shared API envelope (`success/data/error/timestamp`).

## Deliverables
- Request/response DTOs + mapper translating domain models into API payloads.
- Feature-flagged controllers for folders and documents using Spring Security permissions.
- Exception advice that maps editor errors into the standard envelope without leaking implementation details.

## What Was Done
- Added `EditorApiResponse` + error DTOs and typed node/document responses under `core/editor/api/dto/**`.
- Implemented `EditorDtoMapper` to convert aggregates, revisions, and breadcrumbs into response objects.
- Created `EditorFolderController` and `EditorDocumentController`, guarded by `app.features.editor.enabled` and `hasPermissionRule(...)` expressions.
- Extended `FolderService` with `getFolder`/`getBreadcrumb` helpers used by the controllers.
- Enriched editor exceptions with contextual fields and introduced `EditorExceptionHandler` to return envelope-formatted errors.

## Verification
- Manual code inspection only. `./gradlew :backend:test` was **not** executed due to sandbox restrictions on Gradle (wildcard IP/lock issues). Please run the backend test suite locally to confirm wiring.

## Follow-ups / Notes
- Need Spring MVC integration tests (MockMvc) for both controllers in the next task (M1-T7) to cover success + error paths.
- Confirm security expressions (`directory.*`, `document.*`) match actual permission catalog before rollout.
- Once tests exist, ensure OpenAPI generation includes the new endpoints.
