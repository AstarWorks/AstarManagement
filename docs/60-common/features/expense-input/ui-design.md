# 実費入力画面 UI/UXデザイン仕様書

## 1. デザイン原則

### 1.1 基本方針
- **モバイルファースト**: スマートフォンでの素早い入力を最優先
- **シンプル**: 必要最小限の情報のみ表示
- **直感的**: 説明なしで使える操作性
- **高速**: 最小タップ数での入力完了

### 1.2 ビジュアルデザイン
- **カラースキーム**: Astar Managementの既存デザインシステムに準拠
- **フォント**: システムフォント優先（高速表示）
- **スペーシング**: 親指での操作を考慮した余白設計

## 2. 画面詳細設計

### 2.1 実費一覧画面

#### レイアウト構成
```
[ヘッダー]
├─ タイトル「実費管理」
├─ 集計ボタン（アイコン）
└─ メニューボタン（エクスポート等）

[集計サマリー]
├─ 今月の支出合計
└─ 件数

[フィルター/検索バー]
├─ 期間選択
├─ 案件選択
└─ 科目選択
└─ 検索ボックス

[一覧表示]
├─ 日付 | 科目 | 摘要 | 金額
├─ スワイプで編集・削除
└─ 無限スクロール（30件ずつ）

[フローティングアクションボタン]
└─ 「+」新規入力
```

#### インタラクション
- **スワイプ操作**: 左スワイプで編集・削除ボタン表示
- **プルダウン更新**: データの再読み込み
- **長押し**: 複数選択モード（一括削除・エクスポート用）

### 2.2 実費入力画面（モバイル最適化）

#### レイアウト構成
```
[入力フォーム]
├─ 日付（デフォルト：今日）
├─ 科目（ドロップダウン）
├─ 摘要（テキスト入力）
├─ 支出金額（数値キーパッド自動表示）
├─ 収入金額（折りたたみ可能）
├─ 案件（オプション・検索可能ドロップダウン）
├─ メモ（オプション・折りたたみ可能）
└─ 裏付け資料（カメラ/ファイル選択）

[アクション]
├─ 保存して新規作成
└─ 保存して閉じる
```

#### 入力補助機能
- **科目選択**: 使用頻度順に表示
- **テンプレート**: よく使う組み合わせを保存（将来実装）
- **音声入力**: 摘要・メモ欄で利用可能

### 2.3 CSVインポート画面

#### 表示モードの特徴
- **テーブルモード**: 一覧性重視、複数選択が容易
- **カードモード**: 高速判定重視、直感的な操作

#### カードモード詳細
```
[カード表示]
├─ 日付（大きく表示）
├─ 摘要（詳細説明）
├─ 金額（強調表示）
├─ 店舗名/相手先
└─ カテゴリ（自動推定）

[操作エリア]
├─ スワイプジェスチャー対応
├─ アニメーション付きカード切り替え
├─ 判定済みカードのサムネイル表示
└─ やり直しボタン（直前の判定を取り消し）
```

#### インポートフロー
```
1. ファイル選択
   └─ ドラッグ&ドロップ対応（PC）
   └─ ファイル選択ボタン

2. フォーマット確認
   ├─ 自動認識された金融機関名
   ├─ カラムマッピングプレビュー
   └─ 「カスタマイズ」ボタン

3. データプレビュー
   ├─ 表示モード切り替えボタン
   ├─ 【テーブルモード】
   │   ├─ チェックボックス付き一覧（最大30件表示）
   │   ├─ 「すべて選択/解除」
   │   ├─ 科目の一括設定
   │   └─ 案件の一括設定
   └─ 【カードモード】（単語帳形式）
       ├─ 1件ずつ大きく表示
       ├─ スワイプ操作
       │   ├─ 左スワイプ: 除外（事業外）
       │   └─ 右スワイプ: 採用（事業用）
       ├─ ボタン操作
       │   ├─ ✕ ボタン: 除外
       │   └─ ○ ボタン: 採用
       └─ 進捗インジケーター（例: 15/30件）

4. インポート実行
   ├─ 進捗バー表示
   └─ 完了通知
```

#### エラーハンドリング
- **必須カラム不足**: 「必須項目（日付、金額）が見つかりません」
- **フォーマットエラー**: 「日付または金額の形式が正しくありません（行番号表示）」
- **部分的失敗**: 成功/失敗の件数表示とエラー詳細のダウンロード

### 2.4 集計レポート画面

#### レイアウト構成
```
[集計条件]
├─ 期間（月次/四半期/年次/カスタム）
├─ 集計単位（案件/弁護士/科目/全体）
└─ 「集計実行」ボタン

[結果表示]
├─ サマリー（合計金額・件数）
├─ グラフ（円グラフ/棒グラフ切替）
└─ 詳細テーブル

[エクスポート]
├─ PDF出力
└─ CSV出力
```

## 3. レスポンシブ対応

### 3.1 ブレークポイント
- **モバイル**: 〜768px（優先）
- **タブレット**: 768px〜1024px
- **デスクトップ**: 1024px〜

### 3.2 PC版での追加機能
- 一覧画面での一括編集
- キーボードショートカット
- 詳細な絞り込み条件

## 4. アクセシビリティ

- **色覚多様性**: 色だけに依存しない情報設計
- **フォントサイズ**: 最小14px
- **タップ領域**: 最小44×44px
- **キーボード操作**: Tab順序の最適化

## 5. アニメーション仕様

### 5.1 画面遷移
- **デフォルト**: スライドイン/アウト（0.3秒）
- **モーダル**: フェードイン/アウト（0.2秒）

### 5.2 状態変化アニメーション
- **ボタンタップ**: リップルエフェクト
- **チェックボックス**: スムーズなチェックマーク描画
- **削除**: スワイプアウト + フェード
- **追加**: フェードイン + スライドダウン
- **ローディング**: スケルトンスクリーン表示

### 5.3 フィードバック
- **保存成功**: チェックマークアニメーション + トースト通知
- **エラー**: シェイクアニメーション + エラーメッセージ
- **プルリフレッシュ**: 回転するローディングインジケーター

## 6. ダークモード対応

### 6.1 カラーパレット
- **背景色**: 
  - ライト: #FFFFFF
  - ダーク: #1A1A1A
- **カード背景**:
  - ライト: #F5F5F5
  - ダーク: #2D2D2D
- **テキスト**:
  - ライト: #333333
  - ダーク: #E0E0E0
- **アクセントカラー**: 両モード共通（ブランドカラー）

### 6.2 実装方針
- システム設定に追従
- CSS変数による動的切り替え
- 画像・アイコンのダークモード版を用意

## 7. エラー状態とエンプティステート

### 7.1 エラー状態
- **ネットワークエラー**: 再試行ボタン付きメッセージ
- **入力エラー**: フィールド下部に赤色エラーテキスト
- **権限エラー**: 適切な権限要求メッセージ

### 7.2 エンプティステート
- **初回利用時**: 「最初の実費を入力しましょう」+ 入力ボタン
- **検索結果なし**: 「該当する実費が見つかりません」
- **フィルター結果なし**: 「条件を変更してください」